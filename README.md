# КНИР 8-го семестра (WIP)
Джумагельдиев Сергей из БПМ-21-2.

## Требования

Менеджер пакетов [UV](https://docs.astral.sh/uv/).

Видеокарта Nvidia с поддержкой CUDA 12.6 (для более старой версии нужно поменять `cu126` на `cu124` или `cu118` в `tool.uv.index.url` в `pyproject.toml`, а для обучения на процессоре - удалить всё, что ниже `dependencies`).

## Подготовка

Установка зависимостей:

`uv sync`

Распаковка предварительно подготовленых VFMs базового фантома (вместо использования `scripts/cut_phantom.py`):

`uv run scripts/unpack_phantom.py`

## Запуск

### Генерация данных

Генерация данных для конфигурации по умолчанию (`./cfg/cfg_0`) с наличием сигналов:

`uv run python -m data_generation -d`

Данные будут добавлены в папку `./dataset`, демонстрационные изображения в `./.temp/out`, а маска сигналов - `./.temp/mask_*.png`.

__Для работы остальных модулей также необходимо сгенерировать данные без сигналов:__

`uv run python -m data_generation -s -e`

### Модели 

Проверка альтернативной модели:

`uv run python -m test`

Обучение основной модели (для демонстрации в качестве целевой переменной выступает `signal_present`, а не `human_score`):

`uv run python -m model --epochs 2`

### Разметка

Небольшая программа для ручной классификации областей интереса на томограммах (клавиша 'z' - нет сигнала, клавиша '/' - есть):

`uv run python -m labeling`